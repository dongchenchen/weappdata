const Constants = require('../common/constants');

var response = {"base":{"session":
{"_fake_id":"1718116614","_sid_ticket":"903b06189f424f2ad6d7d4da62c59bcd6de75dd5",
"_data_ticket":"gynQao1YJ3Xg8POz5toCQYqM","_sid_expire":1533305358},"ret":0},
"body":{"tables":[{"id":"1","count":3,
"lines":[
{"fields":[{"key":"money","value":"983420529"},
{"key":"comp_day1_money","value":"-"},
{"key":"comp_week1_money","value":"-"},
{"key":"comp_week2_money","value":"-"}]},
{"fields":[{"key":"msg_pv","value":"2692282637"},
{"key":"comp_day1_msg_pv","value":"-"},{"key":"comp_week1_msg_pv","value":"-"},
{"key":"comp_week2_msg_pv","value":"-"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"comp_day1_share_pv","value":"-"},
{"key":"comp_week1_share_pv","value":"-"},{"key":"comp_week2_share_pv","value":"-"}]}]}]}}



var fields = [{"key":"money","value":"983420529"},
{"key":"comp_day1_money","value":"-"},
{"key":"comp_week1_money","value":"-"},
{"key":"comp_week2_money","value":"-"}];


export const hh = {"base":{"session":{"_fake_id":"1718116614","_sid_ticket":"903b06189f424f2ad6d7d4da62c59bcd6de75dd5",
"_data_ticket":"gynQao1YJ3Xg8POz5toCQYqM","_sid_expire":1533305358},"ret":0},"body":
{"tables":[{"id":"2","count":2,
"lines":
[{"fields":[{"key":"share_pv","value":"2211212"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"121212"},
{"key":"ds","value":"20180801"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180802"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180803"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180804"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180805"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180806"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180807"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180808"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180809"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180810"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180811"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180812"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180813"}]},
{"fields":[{"key":"share_pv","value":"104285376"},
{"key":"msg_pv","value":"2692282637"},
{"key":"money","value":"983420529"},
{"key":"ds","value":"20180814"}]}

]}]}}


export const mm = {"base":{"session":{"_fake_id":"1718116614","_sid_ticket":"903b06189f424f2ad6d7d4da62c59bcd6de75dd5",
"_data_ticket":"gynQao1YJ3Xg8POz5toCQYqM","_sid_expire":1533305358},"ret":0},
"body":{"tables":[{"id":"3","count":18,"lines":
[{"fields":[{"key":"trend_val","value":"4"},
{"key":"trend_key_type","value":"sendtime"},
{"key":"msg_pv","value":"181611251"},
{"key":"ds","value":"20180802"}]},
{"fields":[{"key":"trend_val","value":"2"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"95596521"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"4"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"179700669"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"1"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"1204983016"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"-1"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"6324"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"0"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"2209281006"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"1"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"1207005682"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"5"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"325207007"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"5"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"329294312"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"2"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"588855086"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"0"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"2226218612"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"1"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"378382759"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"2"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"604088884"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"3"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"391626277"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"1"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"372003186"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"2"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"104612137"},
{"key":"ds","value":"20180802"}]},{"fields":[{"key":"trend_val","value":"3"},
{"key":"trend_key_type","value":"sendtime"},{"key":"msg_pv","value":"373735096"},
{"key":"ds","value":"20180801"}]},{"fields":[{"key":"trend_val","value":"-1"},
{"key":"trend_key_type","value":"reprinttype"},{"key":"msg_pv","value":"6735"},{"key":"ds","value":"20180802"}]}]}]}}

export const tranform_result = response => {
	let tables = response.body.tables;
	let conditions = [];
	if(tables.length > 0) {
		for(let table of tables) {			
			for(let lines of table.lines) {
				let fields = lines.fields;
				let cond = fields.reduce((condition,current) => {
					let currentKey = current.key;
					if(Constants.CONDITION_KEY[currentKey]) {
						condition.index_key = currentKey;
					}
					condition[currentKey] = current.value;
					return condition;
				},{});
				conditions.push(cond);
			}			
		}
	}
	return conditions;
}

// tranform_result(response);


// ine_list {
//     data_list {
//       key: "trend_val"           这个表示类型的值，下面的是sendtime所等于的
//       value: "5"
//     }
//     data_list {
//       key: "trend_key_type"   这个表示趋势图的类型
//       value: "sendtime"        比如这个字段和windy说明的字段保持一致
//     }
//     data_list {
//       key: "msg_pv"            这个表示pv值
//       value: "329294312"
//     }
//     data_list {
//       key: "ds"                这个表示日期
//       value: "20180801"
//     }
//   }


// line_list {
// 	trend_val: "5",
// 	trend_key_type: "sendtime",
// 	msg_pv: "32121221",
// 	ds: "20180801"
// }

// let result = res.resp.list;
// 					for(let item of result) {
// 						let pvLine = {};
// 						pvLine.key = item.index_key;
// 						let canvasData = {line:[], commFlag: [], xCoordinate: Util.getXCoordinates(timeStamp)};
// 						let legendList = Constants.PV_CHART_LEGEND[item.index_key];
// 						for(let line of item.line) {
// 							let lineItem = {hidden: false};
// 							lineItem.legend = legendList[line.key];
// 							lineItem.point = [];
// 							for(let point of line.index_point) {
// 								let line_point = {
// 									value: Util.formatDouble(point.point_val),
// 									flag: Util.formatDouble(point.point_val)
// 								}
// 								lineItem.point.push(line_point);
// 							}
// 							canvasData.line.push(lineItem);							
// 						}
// 						pvLine.title = Constants.PV_CHART_NAME[pvLine.key];
// 						pvLine.canvasData = canvasData;
// 						pvLine.canvasOption = StyleConfig.common_line_option;
// 						pvLine.canvasStyle = StyleConfig.common_line_style;
// 						pvLineList.push(pvLine);
// 					}

// const format_pv_line = response => {
// 	let line_list = response.line_list;
// 	let len = line_list.length;
// 	let pvLineList = [];
// 	let pvLineType = [];
// 	let pvChartType = [];
// 	let pvChartList = [];
// 	//分成几个表
// 	for(let i = 0; i < len; i++) {
// 		let point = line_list[i];
// 		for(let j = 0; j < point.length; j++) {
// 			let point_info = point[j];
// 			if(point_info.key == 'trend_key_type'){
// 				if(pvChartType.indexOf(point_info.value) == -1) {
// 					let newChart = {};
// 					newChart.index_key = point_info.value;
// 					newChart.point_list = [];
// 					newChart.point_list.push(point_info);
// 					pvChartType.push(point_info.value);
// 					pvChartList.push(newChart);
// 				}
// 				else 
// 				{
// 					let index = pvChartType.indexOf(point_info.value);
// 					pvChartList[index].point_list.push(point_info);
// 				}
// 			}
// 		}
// 	}

// 	//对每个表的每条线进行分隔
// 	for(let i = 0; i < pvChartType.length; i++) {
// 		let point_list = pvChartType[i].point_list;
// 		for(let j = 0; j < point_list.length; j++){
// 			let point_info = point_list[j];
// 			if(point_info.key == 'trend_val') {
// 				if(pvLineType.indexOf(point_info.value) == -1) {
// 					let line = {};

// 				}
// 			}
// 		}
// 	}
// }

// line_list {
//     data_list {
//       key: "money"
//       value: "983420529"
//     }
//     data_list {
//       key: "comp_day1_money"
//       value: "-"
//     }
//     data_list {
//       key: "comp_week1_money"
//       value: "-"
//     }
//     data_list {
//       key: "comp_week2_money"
//       value: "-"
//     }
//   }